---
---

<section class="container landing-cta">
  <div class="cta-panel reveal">
    <div class="cta-panel-barcode" aria-hidden="true"></div>
    <div class="cta-content">
      <h2 class="cta-title">Join the Waitlist</h2>
      <p class="cta-desc">Get early access, release updates, and product notes from the Signet team.</p>
    </div>

    <form id="waitlist-form" class="cta-waitlist">
      <div class="cta-waitlist-row">
        <input
          id="waitlist-email"
          name="email"
          type="email"
          class="cta-email-input"
          placeholder="you@company.com"
          required
          autocomplete="email"
        />
        <button type="submit" class="btn btn-primary cta-submit-btn">Join Waitlist</button>
      </div>
      <p class="cta-email-note">No spam. Unsubscribe anytime.</p>
    </form>

    <div id="waitlist-success" class="cta-success" hidden>
      <p class="cta-success-msg">You're on the list. We'll be in touch.</p>
    </div>
  </div>
</section>

<script>
  const form = document.getElementById('waitlist-form') as HTMLFormElement | null;
  const success = document.getElementById('waitlist-success');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = new FormData(form).get('email');
    const btn = form.querySelector('.cta-submit-btn') as HTMLButtonElement;

    btn.textContent = 'Submitting...';
    btn.disabled = true;

    try {
      const res = await fetch('/api/waitlist', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email }),
      });

      if (res.ok) {
        form.hidden = true;
        if (success) success.hidden = false;
      } else {
        btn.textContent = 'Try Again';
        btn.disabled = false;
      }
    } catch {
      btn.textContent = 'Try Again';
      btn.disabled = false;
    }
  });
</script>
